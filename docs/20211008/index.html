<!DOCTYPE html><html dir="ltr" lang="en"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 26.14.0">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font:small Helvetica Neue,sans-serif,Droid Sans Fallback;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>ShapeVOWL: RDF Constraints Visualization based on VOWL</title>
    

    
<link rel="stylesheet" type="text/css" href="../resources/css/style.css">
    
<link rel="stylesheet" type="text/css" href="../resources/css/extras.css">
    
    

<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
.hljs{background:0 0!important}
a abbr,h1 abbr,h2 abbr,h3 abbr,h4 abbr,h5 abbr,h6 abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
code{color:#c63501}
th code{color:inherit}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
a[href].self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
h2,h3,h4,h5,h6{position:relative}
aside.example .marker>a.self-link{color:inherit}
h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{border:none;color:inherit;font-size:83%;height:2em;left:-1.6em;opacity:.5;position:absolute;text-align:center;text-decoration:none;top:0;transition:opacity .2s;width:2em}
h2>a.self-link::before,h3>a.self-link::before,h4>a.self-link::before,h5>a.self-link::before,h6>a.self-link::before{content:"ยง";display:block}
@media (max-width:767px){
dd{margin-left:0}
h2>a.self-link,h3>a.self-link,h4>a.self-link,h5>a.self-link,h6>a.self-link{left:auto;top:auto}
}
@media print{
.removeOnSave{display:none}
}
</style>
<meta name="description" content="This document  defines ShapeVOWL, a visual notation for RDF constraints.
It specifies the visualization primitives to represent constraints to users.">
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "unofficial",
  "shortName": "shape-vowl",
  "authors": [
    {
      "name": "Sven Lieber",
      "url": "https://sven-lieber.org",
      "company": "Royal Library of Belgium (KBR)",
      "companyURL": "https://www.kbr.be/en"
    }
  ],
  "doRdfa": "true",
  "copyrightStart": "2020",
  "edDraftURI": "https://w3id.org/imec/unshacled/spec/shape-vowl/",
  "otherLinks": [
    {
      "key": "This Version",
      "data": [
        {
          "value": "https://w3id.org/imec/unshacled/spec/shape-vowl/20211008/",
          "href": "https://w3id.org/imec/unshacled/spec/shape-vowl/20211008/"
        }
      ]
    },
    {
      "key": "Previous Version",
      "data": [
        {
          "value": "https://w3id.org/imec/unshacled/spec/shape-vowl/20210118/",
          "href": "https://w3id.org/imec/unshacled/spec/shape-vowl/20210118/"
        }
      ]
    }
  ],
  "editors": [
    {
      "name": "Sven Lieber",
      "url": "https://sven-lieber.org",
      "company": "Royal Library of Belgium (KBR)",
      "companyURL": "https://www.kbr.be/en"
    },
    {
      "name": "Anastasia Dimou",
      "url": "https://twitter.com/natadimou",
      "company": "DTAI - KU Leuven",
      "companyURL": "https://dtai.cs.kuleuven.be/"
    }
  ],
  "localBiblio": {
    "RDF": {
      "title": "RDF 1.1 Concepts and Abstract Syntax",
      "href": "https://www.w3.org/TR/rdf11-concepts/",
      "publisher": "W3C",
      "id": "rdf"
    },
    "SHACL": {
      "title": "Shapes Constraint Langauge (SHACL)",
      "href": "https://www.w3.org/TR/shacl/",
      "publisher": "W3C",
      "id": "shacl"
    },
    "SHACL-abstract": {
      "title": "Shapes Constraint Langauge (SHACL) - Abstract",
      "href": "https://www.w3.org/TR/shacl/#abstract",
      "publisher": "W3C",
      "id": "shacl-abstract"
    },
    "SHACL-core-constraints": {
      "title": "Shapes Constraint Langauge (SHACL) - Constraint Types",
      "href": "https://www.w3.org/TR/shacl/#core-components",
      "publisher": "W3C",
      "id": "shacl-core-constraints"
    },
    "VOWL": {
      "title": "Visual Notation for OWL Ontologies (VOWL)",
      "href": "http://vowl.visualdataweb.org/v2/",
      "id": "vowl"
    },
    "QueryVOWL": {
      "title": "QueryVOWL",
      "href": "http://vowl.visualdataweb.org/queryvowl/index.html",
      "id": "queryvowl"
    },
    "MapVOWL": {
      "title": "MapVOWL",
      "href": "https://rml.io/specs/mapvowl/",
      "publisher": "rml.io",
      "id": "mapvowl"
    }
  },
  "publishISODate": "2021-10-08T00:00:00.000Z",
  "generatedSubtitle": "Unofficial Draft 08 October 2021"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2016/W3C-UD"></head>
<body class="h-entry informative"><div class="head">
     <h1 id="title" class="title">ShapeVOWL: RDF Constraints Visualization based on VOWL</h1>
    
    <h2>Unofficial Draft <time class="dt-published" datetime="2021-10-08">08 October 2021</time></h2>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        
        <dt>Latest editor's draft:</dt><dd><a href="https://w3id.org/imec/unshacled/spec/shape-vowl/">https://w3id.org/imec/unshacled/spec/shape-vowl/</a></dd>
        
        
        
        
        
        
        <dt>Editors:</dt>

      <dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://sven-lieber.org">Sven Lieber</a> (<a class="p-org org h-org" href="https://www.kbr.be/en">Royal Library of Belgium (KBR)</a>) </dd><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://twitter.com/natadimou">Anastasia Dimou</a> (<a class="p-org org h-org" href="https://dtai.cs.kuleuven.be/">DTAI - KU Leuven</a>) </dd>
        
      <dt>Author:</dt><dd class="p-author h-card vcard"><a class="u-url url p-name fn" href="https://sven-lieber.org">Sven Lieber</a> (<a class="p-org org h-org" href="https://www.kbr.be/en">Royal Library of Belgium (KBR)</a>) </dd>
        
        <dt>This Version</dt><dd>
    <a href="https://w3id.org/imec/unshacled/spec/shape-vowl/20211008/">https://w3id.org/imec/unshacled/spec/shape-vowl/20211008/</a>
  </dd><dt>Previous Version</dt><dd>
    <a href="https://w3id.org/imec/unshacled/spec/shape-vowl/20210118/">https://w3id.org/imec/unshacled/spec/shape-vowl/20210118/</a>
  </dd>
      </dl>
    </details>
    
    
    
    <p class="copyright">
      This document is licensed under a
      <a rel="license" href="https://creativecommons.org/licenses/by/4.0/legalcode" class="subfoot">Creative Commons Attribution 4.0 International Public License</a>
      (CC-BY).
    </p>
    <hr title="Separator for header">
  </div>
<section id="abstract" class="introductory"><h2>Abstract</h2><p>This document  defines ShapeVOWL, a visual notation for RDF constraints.
It specifies the visualization primitives to represent constraints to users.</p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">2. </bdi>Terminology</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#general"><bdi class="secno">2.1 </bdi>General</a></li><li class="tocline"><a class="tocxref" href="#visualization"><bdi class="secno">2.2 </bdi>Visualization</a></li></ol></li><li class="tocline"><a class="tocxref" href="#graphical-primitives"><bdi class="secno">3. </bdi>Graphical Primitives</a></li><li class="tocline"><a class="tocxref" href="#colors"><bdi class="secno">4. </bdi>Colors</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#general-0"><bdi class="secno">4.1 </bdi>General</a></li><li class="tocline"><a class="tocxref" href="#color-schemas"><bdi class="secno">4.2 </bdi>Color Schemas</a></li></ol></li><li class="tocline"><a class="tocxref" href="#constraints"><bdi class="secno">5. </bdi>Constraints</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#semantic-constructs-0"><bdi class="secno">5.1 </bdi>Semantic constructs</a></li><li class="tocline"><a class="tocxref" href="#splitting-rules"><bdi class="secno">5.2 </bdi>Splitting rules</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#duplicate-property-shape"><bdi class="secno">5.2.1 </bdi>Duplicate property shape</a></li><li class="tocline"><a class="tocxref" href="#duplicate-property-path"><bdi class="secno">5.2.2 </bdi>Duplicate property path</a></li><li class="tocline"><a class="tocxref" href="#no-duplication"><bdi class="secno">5.2.3 </bdi>No duplication</a></li></ol></li><li class="tocline"><a class="tocxref" href="#example"><bdi class="secno">5.3 </bdi>Example</a></li></ol></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">A. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">A.1 </bdi>Informative references</a></li></ol></li></ol></nav>
    <p>
        This document is the result of ongoing research.
    </p>


<section id="introduction"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction<a class="self-link" aria-label="ยง" href="#introduction"></a></h2><p>Knowledge Graphs defined with the Resource Description Framework [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf" title="RDF 1.1 Concepts and Abstract Syntax">RDF</a></cite>] consist of vocabulary terms and instance data both described using the graph model of RDF.
Several constraint languages exist to define conditions on such RDF graphs, one such language is the W3C recommended Shapes Constraint Language [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl" title="Shapes Constraint Langauge (SHACL)">SHACL</a></cite>]
which itself is represented using RDF.
Users rely on different types of constraints offered by constraint languages to define conditions on RDF graphs.</p><p>RDF follows a graph model which intuitively can be represented using nodes and edges.
The Visual Notation for OWL Ontologies [<cite><a class="bibref" data-link-type="biblio" href="#bib-vowl" title="Visual Notation for OWL Ontologies (VOWL)">VOWL</a></cite>] leverages this graph model to visualize ontologies, the vocabulary of terms of Knowledge Graphs.
Besides this, VOWL-based visual notations were also used for the RDF Query Language SPARQL [<cite><a class="bibref" data-link-type="biblio" href="#bib-queryvowl" title="QueryVOWL">QueryVOWL</a></cite>], used to query RDF data, and
for the RDF Mapping Language (RML) [<cite><a class="bibref" data-link-type="biblio" href="#bib-mapvowl" title="MapVOWL">MapVOWL</a></cite>], used to transform structured data to RDF.
ShapeVOWL is an attempt to leverage the broadly used visual notation VOWL for RDF constraints.</p></section>

<section id="terminology"><h2 id="x2-terminology"><bdi class="secno">2. </bdi>Terminology<a class="self-link" aria-label="ยง" href="#terminology"></a></h2><p>Throughout the document, the following terminology is used.</p><section id="general"><h3 id="x2-1-general"><bdi class="secno">2.1 </bdi>General<a class="self-link" aria-label="ยง" href="#general"></a></h3><dl>
  <dt><dfn id="dfn-entity" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">(anonymous) entity</dfn></dt>
  <dd>
    An entity is something that exists as a distinct, independent, or self-contained unit.
    Examples are people, companies, buildings and so on.
    If you want to uniquely address an entity then it needs to have a unique name.
    Therefore, entities use HTTP URIs.
    However, when a entity does not have a URI we call it an <span class="emph">anonymous</span> entity [<cite><a class="bibref" data-link-type="biblio" href="#bib-mapvowl" title="MapVOWL">MapVOWL</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-attribute" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">attribute</dfn></dt>
  <dd>
    More information is provided about an entity by adding attribute to it.
    Examples are the name of a person, the VAT number of a company and so on [<cite><a class="bibref" data-link-type="biblio" href="#bib-mapvowl" title="MapVOWL">MapVOWL</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-relationship" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">relationship</dfn></dt>
  <dd>
    An entity and its attributes are connected with each other using relationships.
    A relationship describes how a attribute relates to its entity [<cite><a class="bibref" data-link-type="biblio" href="#bib-mapvowl" title="MapVOWL">MapVOWL</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-constraints" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">constraints</dfn></dt>
  <dd>
    A constraint is a condition on data which should be satisfied. Several types of constraints exist,
    e.g. a datatype constraint on a property restricts the value of that property to be of a specific datatype
    and a cardinality constraint on a property restricts the number of that property [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl-core-constraints" title="Shapes Constraint Langauge (SHACL) - Constraint Types">SHACL-core-constraints</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-data-shape" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">data shape</dfn></dt>
  <dd>
    A data shape is a set of conditions on RDF data [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl-abstract" title="Shapes Constraint Langauge (SHACL) - Abstract">SHACL-abstract</a></cite>].
    It provides context for constraints, i.e. a datatype constraint can be used
    in different data shapes which corresponds to different contexts.
  </dd>
  
  <dt><dfn id="dfn-node-shape" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">node shape</dfn></dt>
  <dd>
    A node shape is a specific data shape which represents conditions on nodes,
    i.e. subjects and objects of triples [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl" title="Shapes Constraint Langauge (SHACL)">SHACL</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-property-shape" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">property shape</dfn></dt>
  <dd>
    A property shape is a specific data shape which represents conditions on properties and their values,
    i.e. predicates and related objects of triples [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl" title="Shapes Constraint Langauge (SHACL)">SHACL</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-closed-data-shape" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">closed data shape</dfn></dt>
  <dd>
    A closed data shape may only have values for the properties explicitly enumerated via property shapes [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl" title="Shapes Constraint Langauge (SHACL)">SHACL</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-severity" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">severity</dfn></dt>
  <dd>
    Each data shape has a severity which qualifies the violation of the stated conditions, i.e. it categorizes validation results [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl" title="Shapes Constraint Langauge (SHACL)">SHACL</a></cite>].
    By default a data shape has the severity "violation" but other severities can be defined,
    i.e. the SHACL core specifies the three severities "violation", "warning" and "information".
  </dd>
  
</dl></section><section id="visualization"><h3 id="x2-2-visualization"><bdi class="secno">2.2 </bdi>Visualization<a class="self-link" aria-label="ยง" href="#visualization"></a></h3><dl>
            
  <dt><dfn id="dfn-node" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">node</dfn></dt>
  <dd>
    A node is a visual representation of either an entity or an attribute [<cite><a class="bibref" data-link-type="biblio" href="#bib-mapvowl" title="MapVOWL">MapVOWL</a></cite>].
  </dd>
  
  <dt><dfn id="dfn-edge" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">edge</dfn></dt>
  <dd>
    An edge is a line connecting two nodes.
    It represents the relationship between two entities or one entity and one attribute [<cite><a class="bibref" data-link-type="biblio" href="#bib-mapvowl" title="MapVOWL">MapVOWL</a></cite>].
  </dd>
 
  <dt><dfn id="dfn-graph" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">graph</dfn></dt>
  <dd>
    A graph is a collection of nodes and edges [<cite><a class="bibref" data-link-type="biblio" href="#bib-mapvowl" title="MapVOWL">MapVOWL</a></cite>].
  </dd>

</dl></section></section>

<section id="graphical-primitives"><h2 id="x3-graphical-primitives"><bdi class="secno">3. </bdi>Graphical Primitives<a class="self-link" aria-label="ยง" href="#graphical-primitives"></a></h2><table id="tab-vis-prim" class="small-images">
  <tbody><tr>
    <th>Name</th>
    <th>Primitive</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>rectangle with round corners</td>
    <td><img src="../resources/images/primitives/rectangle-round-corners.svg"></td>
    <td>
      <ul>
        <li>node shape</li>
      </ul>
    </td>
  </tr>

  <tr>
    <td>circle</td>
    <td><img src="../resources/images/primitives/circle.svg"></td>
    <td>
      <ul>
        <li>value of a property shape</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>rectangle</td>
    <td><img src="../resources/images/primitives/rectangle.svg"></td>
    <td>
      <ul>
        <li>relationship label</li>
        <li>literal</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>solid line</td>
    <td><img src="../resources/images/primitives/solid-edge.svg"></td>
    <td>
      <ul>
        <li>relationship between a node and a property shape</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>dashed line</td>
    <td><img src="../resources/images/primitives/dashed-edge.svg"></td>
    <td>
      <ul>
        <li>relationship between nodes and data shapes or property shapes and node shapes (not between node shapes and property shapes)</li>
        <li>border of deactivated data shapes</li>
      </ul>
    </td>
  </tr>
  <tr>
    <td>arrowhead</td>
    <td><img src="../resources/images/primitives/arrow-head.svg"></td>
    <td>
       relationship direction
    </td>
  </tr>
  <tr>
    <td>text</td>
    <td>text</td>
    <td>labels, constraints and other textual information</td>
  </tr>
 </tbody></table></section>

<section id="colors"><h2 id="x4-colors"><bdi class="secno">4. </bdi>Colors<a class="self-link" aria-label="ยง" href="#colors"></a></h2><section id="general-0"><h3 id="x4-1-general"><bdi class="secno">4.1 </bdi>General<a class="self-link" aria-label="ยง" href="#general-0"></a></h3><table id="tab-general-colors">
  <tbody><tr>
    <th>Abstract Color Name</th>
    <th colspan="2">Concrete Color Recommendation</th>
    <th>Description</th>
    <th>Application</th>
  </tr>
  <tr>
    <td class="side">canvas</td>
    <td>#ffffff</td>
    <td>white</td>
    <td>Bright color with a good contrast to all other colors.</td>
    <td>canvas where are all other graph elements are shown on</td>
  </tr>
  <tr>
    <td class="side">foreground</td>
    <td style="background: #000000; color: #ffffff">#000000</td>
    <td>black</td>
    <td>Very dark color with a good contrast to all other colors.</td>
    <td>border of elements and edges</td>
  </tr>
  <tr>
    <td class="side">base color</td>
    <td style="background: #aaccff;">#aaccff</td>
    <td>VOWL blue</td>
    <td>We reuse the color 'general' of VOWL.</td>
    <td>standard fill color of data shapes</td>
  </tr>
  <tr>
    <td class="side">datatype color</td>
    <td style="background: #ffcc33;">#ffcc33</td>
    <td>VOWL yellow</td>
    <td>We reuse the color 'datatype' of VOWL.</td>
    <td>standard fill color of literals</td>
  </tr>
  <tr>
    <td class="side">highlight</td>
    <td colspan="2">see next table</td>
    <td>For each data shape the highlight color is a darker shade of the
        base color of that element.
    </td>
    <td>fill color of the graph elements when selected</td>
  </tr>
  <tr>
    <td class="side">severity</td>
    <td colspan="2">see next table</td>
    <td>Every severity has its own color.
    </td>
    <td>border color of the data shape based on its severity; default severity is violation</td>
  </tr>
</tbody></table></section><section id="color-schemas"><h3 id="x4-2-color-schemas"><bdi class="secno">4.2 </bdi>Color Schemas<a class="self-link" aria-label="ยง" href="#color-schemas"></a></h3><table id="tab-color-schemas">
  <tbody><tr>
    <th>Color Schema Name</th>
    <th>Base Color</th>
    <th>Highlight</th>
  </tr>
  <tr>
    <td>base color</td>
    <td style="background: #aaccff;">#aaccff</td>
    <td style="background: #1155cc; color: #ffffff">#1155cc</td>
  </tr>
  <tr>
    <td>severity violation</td>
    <td style="background: #e06666;">#e06666</td>
    <td style="background: #981c1c; color: #ffffff">#b7b7b7</td>
  </tr>
  <tr>
    <td>severity warning (light yellow different from datatype color)</td>
    <td style="background: #ffd966;">#ffd966</td>
    <td style="background: #bf9000; color: #ffffff">#bf9000</td>
  </tr>
  <tr>
    <td>severity information</td>
    <td style="background: #93c47d;">#93c47d</td>
    <td style="background: #38761d; color: #ffffff">#b7b7b7</td>
   </tr>
</tbody></table></section></section>

<section id="constraints"><h2 id="x5-constraints"><bdi class="secno">5. </bdi>Constraints<a class="self-link" aria-label="ยง" href="#constraints"></a></h2><p>First, we provide a mapping from semantic constructs of RDF constraint languages
to visual elements of ShapeVOWL (see figures).
Next, we explain splitting rules with respect to the visualization of property shapes.
Finally, we provide a complete visual example.</p><section id="semantic-constructs-0"><h3 id="x5-1-semantic-constructs"><bdi class="secno">5.1 </bdi>Semantic constructs<a class="self-link" aria-label="ยง" href="#semantic-constructs-0"></a></h3><p>The SHACL specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-shacl" title="Shapes Constraint Langauge (SHACL)">SHACL</a></cite>] contains core constraints and other concepts relevant for data validation.
We provide a mapping of semantic constructs to visual representations with ShapeVOWL,
i.e. in the first figure we provide the mapping from SHACL core constraints
and in the second figure we provide the mapping from other relevant SHACL concepts.</p><figure id="semantic-constructs"> 
  <img src="../resources/images/2021-10-08-shapevowl-core-constraints-summary.svg" style="height:100%;width:100%">
  <figcaption>Figure <bdi class="figno">1</bdi> <span class="fig-title">
    Semantic constructs of SHACL core constraints
    and their visual representation in ShapeVOWL.
  </span></figcaption>
</figure><figure id="semantic-constructs"> 
  <img src="../resources/images/2021-10-08-shapevowl-other-constraints-summary.svg" style="height:100%;width:100%">
  <figcaption>Figure <bdi class="figno">2</bdi> <span class="fig-title">
    Semantic constructs of validation-related SHACL concepts
    and their visual representation in ShapeVOWL.
  </span></figcaption>
</figure></section><section id="splitting-rules"><h3 id="x5-2-splitting-rules"><bdi class="secno">5.2 </bdi>Splitting rules<a class="self-link" aria-label="ยง" href="#splitting-rules"></a></h3><p>Node shapes can be reused by a directed dashed connection, however we recommend splitting rules for the visualization of reused property shapes as trade-off for the graph rendering.
Different splittings for property shapes are possible; in the following we describe three possible splitting rules for property shapes.
Depending on the level of detail, applications may choose one of the splitting rules.</p><p>Property shapes consist of two parts: a solid directed edge with the property path as label in a rectangle and a value the directed edge points too which is either a node or a literal.</p><section id="duplicate-property-shape"><h4 id="x5-2-1-duplicate-property-shape"><bdi class="secno">5.2.1 </bdi>Duplicate property shape<a class="self-link" aria-label="ยง" href="#duplicate-property-shape"></a></h4><p>A reused property shape is visualized for each reuse, i.e. a property shape which is used <code>n</code> times will be visualized <code>n</code> times.</p></section><section id="duplicate-property-path"><h4 id="x5-2-2-duplicate-property-path"><bdi class="secno">5.2.2 </bdi>Duplicate property path<a class="self-link" aria-label="ยง" href="#duplicate-property-path"></a></h4><p>The value of a reused property shape is visualized only once but the directed edge and label are visualized for each reuse.</p></section><section id="no-duplication"><h4 id="x5-2-3-no-duplication"><bdi class="secno">5.2.3 </bdi>No duplication<a class="self-link" aria-label="ยง" href="#no-duplication"></a></h4><p>A reused property shape is visualized only once, i.e. a property shape which is used <code>n</code> times will be visualized exactly one time
and will have <code>n</code> ingoing solid edges to the rectangle containing the property path.</p></section></section><section id="example"><h3 id="x5-3-example"><bdi class="secno">5.3 </bdi>Example<a class="self-link" aria-label="ยง" href="#example"></a></h3><p>Below you can find an example for constraints expressed with ShapeVOWL.</p><figure id="example-shapeuml"> 
  <img src="../resources/images/2021-10-08-shapevowl-example.svg" style="height:100%;width:100%">
  <figcaption>Figure <bdi class="figno">3</bdi> <span class="fig-title">
    Constraints visualized using ShapeVOWL: A subject valid to the Person data shape should have an IRI (1),
    at least one but maximum two <code>ex:address</code> properties (2) of class <code>schema:PostalAddress</code> (3)
    and the object of at least one <code>ex:address</code> property should comply with the existing data shape <code>ex:validAddress</code> (4).
    Additionally, the subject valid to person should either have exactly one <code>ex:fullName</code> or at least one <code>schema:givenName</code> (5)
    and at least one <code>schema:familyName</code> all of datatype <code>xsd:string</code>.
    The value of <code>ex:fullName</code> must not comply with the data shape <code>ex:organizationShape</code> (6).
    Addresses must only have values for the property <code>postalAddress</code> with an exception for <code>rdf:type</code> (7).
    Constraints of the <code>ex:organizationShape</code> are not considered for validation (8). 
  ShapeVOWL also visualizes optional accompanying logos for constraint types (9).
  </span></figcaption>
</figure></section></section>



<section id="references" class="appendix"><h2 id="a-references"><bdi class="secno">A. </bdi>References<a class="self-link" aria-label="ยง" href="#references"></a></h2><section id="informative-references">
    <h3 id="a-1-informative-references"><bdi class="secno">A.1 </bdi>Informative references<a class="self-link" aria-label="ยง" href="#informative-references"></a></h3>
    <dl class="bibliography"><dt id="bib-mapvowl">[MapVOWL]</dt><dd><a href="https://rml.io/specs/mapvowl/"><cite>MapVOWL</cite></a>.  rml.io. URL: <a href="https://rml.io/specs/mapvowl/">https://rml.io/specs/mapvowl/</a></dd><dt id="bib-queryvowl">[QueryVOWL]</dt><dd><a href="http://vowl.visualdataweb.org/queryvowl/index.html"><cite>QueryVOWL</cite></a>. URL: <a href="http://vowl.visualdataweb.org/queryvowl/index.html">http://vowl.visualdataweb.org/queryvowl/index.html</a></dd><dt id="bib-rdf">[RDF]</dt><dd><a href="https://www.w3.org/TR/rdf11-concepts/"><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a>.  W3C. URL: <a href="https://www.w3.org/TR/rdf11-concepts/">https://www.w3.org/TR/rdf11-concepts/</a></dd><dt id="bib-shacl">[SHACL]</dt><dd><a href="https://www.w3.org/TR/shacl/"><cite>Shapes Constraint Langauge (SHACL)</cite></a>.  W3C. URL: <a href="https://www.w3.org/TR/shacl/">https://www.w3.org/TR/shacl/</a></dd><dt id="bib-shacl-abstract">[SHACL-abstract]</dt><dd><a href="https://www.w3.org/TR/shacl/#abstract"><cite>Shapes Constraint Langauge (SHACL) - Abstract</cite></a>.  W3C. URL: <a href="https://www.w3.org/TR/shacl/#abstract">https://www.w3.org/TR/shacl/#abstract</a></dd><dt id="bib-shacl-core-constraints">[SHACL-core-constraints]</dt><dd><a href="https://www.w3.org/TR/shacl/#core-components"><cite>Shapes Constraint Langauge (SHACL) - Constraint Types</cite></a>.  W3C. URL: <a href="https://www.w3.org/TR/shacl/#core-components">https://www.w3.org/TR/shacl/#core-components</a></dd><dt id="bib-vowl">[VOWL]</dt><dd><a href="http://vowl.visualdataweb.org/v2/"><cite>Visual Notation for OWL Ontologies (VOWL)</cite></a>. URL: <a href="http://vowl.visualdataweb.org/v2/">http://vowl.visualdataweb.org/v2/</a></dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">โ</abbr></a>
  </p><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-entity" aria-label="Links in this document to definition: (anonymous) entity" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-entity" aria-label="Permalink for definition: (anonymous) entity. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-attribute" aria-label="Links in this document to definition: attribute" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-attribute" aria-label="Permalink for definition: attribute. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-relationship" aria-label="Links in this document to definition: relationship" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-relationship" aria-label="Permalink for definition: relationship. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-constraints" aria-label="Links in this document to definition: constraints" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-constraints" aria-label="Permalink for definition: constraints. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data-shape" aria-label="Links in this document to definition: data shape" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-data-shape" aria-label="Permalink for definition: data shape. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-node-shape" aria-label="Links in this document to definition: node shape" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-node-shape" aria-label="Permalink for definition: node shape. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-property-shape" aria-label="Links in this document to definition: property shape" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-property-shape" aria-label="Permalink for definition: property shape. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-closed-data-shape" aria-label="Links in this document to definition: closed data shape" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-closed-data-shape" aria-label="Permalink for definition: closed data shape. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-severity" aria-label="Links in this document to definition: severity" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-severity" aria-label="Permalink for definition: severity. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-node" aria-label="Links in this document to definition: node" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-node" aria-label="Permalink for definition: node. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-edge" aria-label="Links in this document to definition: edge" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-edge" aria-label="Permalink for definition: edge. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-graph" aria-label="Links in this document to definition: graph" hidden="">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-graph" aria-label="Permalink for definition: graph. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script></body></html>
